<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta property="og:title" content="AWS Synk Workshop" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://synk.modernize.awsworkshop.io/" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta name="description" content="AWS DevSecOps Modernization Workshop">
<meta name="author" content="James Bland">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Snyk Security :: AWS DevSecOps Modernization Workshop</title>

    
    <link href="/css/nucleus.css?1581741991" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    <link href="/css/hybrid.css?1581741991" rel="stylesheet">
    <link href="/css/featherlight.min.css?1581741991" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1581741991" rel="stylesheet">
    <link href="/css/auto-complete.css?1581741991" rel="stylesheet">
    <link href="/css/theme.css?1581741991" rel="stylesheet">
    <link href="/css/hugo-theme.css?1581741991" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1581741991" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1581741991"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
    
  </head>
  <body class="" data-url="/amp/40_snyk/1_snyk.html">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/" title="Go home"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 30" width="60%" style="padding:20px 0px;"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg></a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1581741991"></script>
<script type="text/javascript" src="/js/auto-complete.js?1581741991"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/localhost";
    
</script>
<script type="text/javascript" src="/js/search.js?1581741991"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/10_prerequisites.html" title="Prerequisites" class="dd-item 
        
        
        
        ">
      <a href="/10_prerequisites.html">
          Prerequisites
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/amp/10_prerequisites/1_aws_account.html" title="Create an AWS account" class="dd-item ">
        <a href="/amp/10_prerequisites/1_aws_account.html">
        Create an AWS account
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/20_getting-started.html" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/20_getting-started.html">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/amp/20_getting-started/1_getting_started.html" title="Creating your environment" class="dd-item ">
        <a href="/amp/20_getting-started/1_getting_started.html">
        Creating your environment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/30_workshop_app_ci_cd.html" title="Build and Deploy Sample App with CI/CD" class="dd-item 
        
        
        
        ">
      <a href="/30_workshop_app_ci_cd.html">
          Build and Deploy Sample App with CI/CD
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/amp/30_workshop_app_ci_cd/1_base_services.html" title="Setup Basic Services" class="dd-item ">
        <a href="/amp/30_workshop_app_ci_cd/1_base_services.html">
        Setup Basic Services
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/amp/30_workshop_app_ci_cd/10_push_to_repo.html" title="Build &amp; Push to Repo" class="dd-item ">
        <a href="/amp/30_workshop_app_ci_cd/10_push_to_repo.html">
        Build &amp; Push to Repo
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/amp/30_workshop_app_ci_cd/20_ecs_fargate.html" title="Deploy ECS Fargate Service" class="dd-item ">
        <a href="/amp/30_workshop_app_ci_cd/20_ecs_fargate.html">
        Deploy ECS Fargate Service
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/amp/30_workshop_app_ci_cd/30_pipeline.html" title="Deploy CI/CD Pipeline" class="dd-item ">
        <a href="/amp/30_workshop_app_ci_cd/30_pipeline.html">
        Deploy CI/CD Pipeline
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/40_snyk.html" title="Snyk Security" class="dd-item 
        parent
        
        
        ">
      <a href="/40_snyk.html">
          Snyk Security
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/amp/40_snyk/1_snyk.html" title="Snyk Security" class="dd-item active">
        <a href="/amp/40_snyk/1_snyk.html">
        Snyk Security
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/50_conclusion.html" title="Conclusion" class="dd-item 
        
        
        
        ">
      <a href="/50_conclusion.html">
          Conclusion
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/amp/50_conclusion/1_after_thoughts.html" title="Congratulations" class="dd-item ">
        <a href="/amp/50_conclusion/1_after_thoughts.html">
        Congratulations
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/amp/50_conclusion/10_cleanup.html" title="Cleanup" class="dd-item ">
        <a href="/amp/50_conclusion/10_cleanup.html">
        Cleanup
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <left>

    <h2 class="github-title">Github Repos</h2>

    <h3 class="github-title">AWS Modernization DevSecOps Workshop</h3>
    <a class="github-button" href="https://github.com/aws-samples/aws-modernization-with-snyk" data-icon="octicon-star" data-show-count="true" aria-label="Star on GitHub">Star</a>
    &nbsp;<a class="github-button" href="https://github.com/aws-samples/aws-modernization-with-snyk/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork on GitHub">Fork</a><br />

    <h5 class="copyright">&copy; 2019 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>

</left>

<script async defer src="https://buttons.github.io/buttons.js"></script> 

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/amp/'>DevSecOps with Snyk</a> > <a href='/40_snyk.html'>Snyk Security</a> > Snyk Security
          
        
          
        
          
        
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#snyk-security">Snyk Security</a>
<ul>
<li><a href="#expected-outcome">Expected Outcome</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#snyk-cli">Snyk CLI</a></li>
<li><a href="#tasks-for-this-lab">Tasks for this Lab</a></li>
<li><a href="#create-a-snyk-account-and-obtain-a-token">Create a Snyk Account and Obtain a Token</a></li>
<li><a href="#save-password-to-session-manager">Save Password to Session Manager</a></li>
<li><a href="#setup-the-application-scanning">Setup the Application Scanning</a></li>
<li><a href="#setting-up-docker-scanning">Setting Up Docker Scanning</a></li>
<li><a href="#exercise-testing">Exercise - Testing</a></li>
<li><a href="#exercise-fixing-the-vulnerability">Exercise - Fixing the Vulnerability</a></li>
<li><a href="#viewing-reporting">Viewing Reporting</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Snyk Security</h1>
          

        




<h2 id="snyk-security">Snyk Security</h2>

<h3 id="expected-outcome">Expected Outcome</h3>

<ul>
<li>Install Snyk</li>
<li>Test open source dependencies of the Petstore application, have it fail, remediate security issue, and then have it pass.</li>
<li>Test a docker image for security vulnerabilities</li>
</ul>

<p><strong>Lab Requirements:</strong> Automation lab must be completed</p>

<p><strong>Average Lab Time:</strong> 30 minutes</p>

<h3 id="introduction">Introduction</h3>

<p>This module is designed to introduce scanning <strong>open source dependencies</strong> of the application and the <strong>Docker</strong> container that is created during this workshop. The files required for this module have already been created and reside in the /modules/snyk folder. You will copy these over while following the steps below.</p>

<h3 id="background">Background</h3>

<p><strong>Snyk</strong> is a <strong>SaaS</strong> offering that organizations use to <strong>find, fix, prevent and monitor</strong> open source dependencies. Snyk is a developer first platform that can be easily integrated into the Software Development Lifecycle (SDLC).</p>

<p>At this point of the module, the <code>Petstore</code> application is created, so we will look to insert <strong>Snyk</strong> as part of an important security gate during the build process.</p>

<p>This module will demonstrate how to fail a build when high severity issues are found so that remediation can take place.</p>

<h3 id="snyk-cli">Snyk CLI</h3>

<p>The Snyk command line interface (CLI) has three key commands for this exercise:
- <code>snyk auth</code> which links the CLI to your account and authorizes it to perform tests.
  - We will utilize Amazon&rsquo;s System Manager Parameters to store this token to avoid hard-coding tokens.
  - Alternatively to using <strong>snyk auth</strong>, you can also set an <strong>environment variable</strong>  <code>SNYK_TOKEN</code> which the CLI will automatically detect.
- <code>snyk test</code> performs the actual test and can fail a build
- <code>snyk monitor</code> posts a snapshot for continuous monitoring and reporting on the <code>snyk.io</code> interface where you created your account.</p>

<h3 id="tasks-for-this-lab">Tasks for this Lab</h3>

<p>For the purposes of this module, <strong>Snyk</strong> will be inserted into two key processes, when the <strong>application</strong> is being built, and when the <strong>Docker container</strong> is created.</p>

<p>This module has five sections:
1. Obtain a token for testing from <code>https://snyk.io/</code>
2. Setting up application scanning
3. Setting up Docker analysis
4. Running a test and fixing the issue(s) detected
5. Viewing the status on the Snyk dashboard</p>

<h3 id="create-a-snyk-account-and-obtain-a-token">Create a Snyk Account and Obtain a Token</h3>

<p>Obtain an account and setting up the credentials for this exercise:</p>

<ul>
<li>You will sign up to <a href="https://app.snyk.io/signup" target="_blank">https://app.snyk.io/signup</a> using <code>Google</code>, <code>Bitbucket</code> or <code>Github</code> credentials. <strong>Snyk</strong> utilizes these services for authentication and does not store passwords.</li>
</ul>

<p><img src="/images/snyk_1_login.png" alt="Snyk login" /></p>

<ul>
<li>Once signed up you will navigate to <strong>your name</strong> (top right), and select <strong>Account Settings</strong></li>
</ul>

<p><img src="/images/snyk_2_account_settings.png" alt="Snyk account settings" /></p>

<ul>
<li>Under <strong>API Token</strong>, click <strong>Show</strong> and copy this value, it will be unique for each user.</li>
</ul>

<p><img src="/images/snyk_3_api_token.png" alt="Snyk API token" /></p>

<ul>
<li>Clicking <strong>Show</strong> reveals the token to copy.</li>
</ul>

<p><img src="/images/snyk_3b_api_token_show.png" alt="Snyk API token show" /></p>

<h3 id="save-password-to-session-manager">Save Password to Session Manager</h3>

<p>Run the following command, replacing <code>abc123</code>, with <strong>your unique token</strong>. This places the token in the session parameter manager.</p>

<pre><code>aws ssm put-parameter --name &quot;snykAuthToken&quot; --value &quot;abc123&quot; --type SecureString
</code></pre>

<h3 id="setup-the-application-scanning">Setup the Application Scanning</h3>

<p>We want to insert testing with <strong>Snyk</strong> after <code>maven</code> has built the application. The simplest method is to insert commands to download, authorize and run the <strong>Snyk</strong> commands after Mvn has built the application/dependency tree.</p>

<p>In <code>modules/snyk/Dockerfile</code>, we have inserted the following commands to perform these actions</p>

<p>Set an environment variable from a value passed to the <code>docker build</code> command, this will contain the token for <strong>Snyk</strong>. By using an environment variable, <strong>Snyk</strong> will automatically detect the token when used.</p>

<pre><code>#~~~~~~~SNYK Variable~~~~~~~~~~~~
# Declare Snyktoken as a build-arg
ARG snyk_auth_token
# Set the SNYK_TOKEN environment variable
ENV SNYK_TOKEN=${snyk_auth_token}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre>

<p>Download <strong>Snyk</strong>, run a test, looking for medium to high severity issues, and if the build succeeds, post the results to <strong>Snyk</strong> for monitoring and reporting. If a new vulnerability is found, you will be notified.</p>

<pre><code># package the application
RUN mvn package -Dmaven.test.skip=true

#~~~~~~~SNYK test~~~~~~~~~~~~
# download, configure and run snyk. Break build if vulns present, post results to `https://snyk.io/`
RUN curl -Lo ./snyk &quot;https://github.com/snyk/snyk/releases/download/v1.210.0/snyk-linux&quot;
RUN chmod -R +x ./snyk
#Auth set through environment variable
RUN ./snyk test --severity-threshold=medium
RUN ./snyk monitor
</code></pre>

<h3 id="setting-up-docker-scanning">Setting Up Docker Scanning</h3>

<p>Later in the build process, a docker image is created. We want to analyze it for vulnerabilities. We will do this in <code>buildspec.yml</code>. First, pull the <strong>Snyk</strong> token <code>snykAuthToken</code> from the <code>parameter store</code>:</p>

<pre><code>env:
  parameter-store:
    SNYK_AUTH_TOKEN: &quot;snykAuthToken&quot;
</code></pre>

<p>In the <code>prebuild</code> phase, we will install Snyk</p>

<pre><code>phases:
  pre_build:
    commands:

      - PWDUTILS=$(pwd)
      - curl -Lo ./snyk &quot;https://github.com/snyk/snyk/releases/download/v1.210.0/snyk-linux&quot;
      - chmod -R +x ./snyk
</code></pre>

<p>In the <code>build</code> phase we will pass the token to the <strong>docker compose</strong> command where it will be retrieved in the Dockerfile code we previously setup to test the application:</p>

<pre><code>build:
    commands:
      - docker build --build-arg snyk_auth_token=$SNYK_AUTH_TOKEN -t $REPOSITORY_URI:latest .
</code></pre>

<p>Next we will <strong>authorize</strong> the <strong>Snyk</strong> instance for testing the Docker image that’s produced. If it passes we will pass the results to <strong>Snyk</strong> for monitoring and reporting.</p>

<pre><code>build:
    commands:
      - $PWDUTILS/snyk auth $SNYK_AUTH_TOKEN
      - $PWDUTILS/snyk test --docker $REPOSITORY_URI:latest
      - $PWDUTILS/snyk monitor --docker $REPOSITORY_URI:latest
      - docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG
</code></pre>

<p>In terminal, <strong>navigate</strong> to this folder:</p>

<pre><code>cd ~/environment/aws-modernization-workshop/
</code></pre>

<p>To try this module, let us copy the <strong>Snyk</strong> versions over to our build:</p>

<pre><code>cp modules/snyk/Dockerfile modules/containerize-application/Dockerfile
cp modules/snyk/buildspec.yml buildspec.yml
</code></pre>

<h3 id="exercise-testing">Exercise - Testing</h3>

<p>In the <code>Containerize Application</code> lab you saw how to build your application. In this exercise you will try to run your build, which will fail due to security vulnerabilities being found. While normally done during the code development phase, we will take you through the process of fixing the vulnerability, and then re-running the exercise to see the build succeed.</p>

<p><em>Save changes</em>:</p>

<pre><code>git commit -am &quot;snyk&quot;
</code></pre>

<p><em>Push</em>:</p>

<pre><code>git push -f codecommit master
</code></pre>

<p>Now in <code>CodeBuild</code>, look at your <strong>build history</strong>. Note it may take a minute or two for the new scan to run.</p>

<p><img src="/images/snyk_4_Build.png" alt="Snyk build" /></p>

<p>Let’s look at why this failed. We see security vulnerabilities were found and we’re told <strong>how</strong> to fix it!</p>

<pre><code>Testing /usr/src/app...
✗ Medium severity vulnerability found in org.primefaces:primefaces
Description: Cross-site Scripting (XSS)
Info: https://snyk.io/vuln/SNYK-JAVA-ORGPRIMEFACES-31642
Introduced through: org.primefaces:primefaces@6.1
From: org.primefaces:primefaces@6.1
Remediation:
Upgrade direct dependency org.primefaces:primefaces@6.1 to org.primefaces:primefaces@6.2 (triggers upgrades to org.primefaces:primefaces@6.2)
✗ Medium severity vulnerability found in org.primefaces:primefaces
Description: Cross-site Scripting (XSS)
Info: https://snyk.io/vuln/SNYK-JAVA-ORGPRIMEFACES-31643
Introduced through: org.primefaces:primefaces@6.1
From: org.primefaces:primefaces@6.1
Remediation:
Upgrade direct dependency org.primefaces:primefaces@6.1 to org.primefaces:primefaces@6.2 (triggers upgrades to org.primefaces:primefaces@6.2)
Organisation: sample-integrations
Package manager: maven
Target file: pom.xml
Open source: no
Project path: /usr/src/app
Tested 37 dependencies for known vulnerabilities, found 2 vulnerabilities, 2 vulnerable paths.
The command '/bin/sh -c ./snyk test' returned a non-zero code: 1
[Container] 2018/11/09 03:46:22 Command did not exit successfully docker build --build-arg snyk_auth_token=$SNYK_AUTH_TOKEN -t $REPOSITORY_URI:latest . exit status 1
[Container] 2018/11/09 03:46:22 Phase complete: BUILD Success: false
[Container] 2018/11/09 03:46:22 Phase context status code: COMMAND_EXECUTION_ERROR Message: Error while executing command: docker build --build-arg snyk_auth_token=$SNYK_AUTH_TOKEN -t $REPOSITORY_URI:latest .. Reason: exit status 1
</code></pre>

<h3 id="exercise-fixing-the-vulnerability">Exercise - Fixing the Vulnerability</h3>

<p>According to the remediation, we need to fix the <code>PrimeFaces</code> dependency and update it from version <code>6.1</code> to <code>6.2</code>.</p>

<p>Let us pretend the developer fixed it and checked it in, coming back into the pipeline. This is done by changing.</p>

<p><code>~/environment/aws-modernization-workshop/modules/containerize-application/app/pom.xml</code></p>

<p><em>Changing:</em></p>

<pre><code>&lt;version.primefaces&gt;6.1&lt;/version.primefaces&gt;
</code></pre>

<p><em>To:</em></p>

<pre><code>&lt;version.primefaces&gt;6.2&lt;/version.primefaces&gt;
</code></pre>

<p>Run this command to copy over our fixed version in the lab:</p>

<pre><code>cp modules/snyk/pom.xml modules/containerize-application/app/
</code></pre>

<p><em>Save changes:</em></p>

<pre><code>git commit -am &quot;Fix vulnerable open source dep.&quot;
</code></pre>

<p><em>Push:</em></p>

<pre><code>git push -f codecommit master
</code></pre>

<p>This time check <code>Code Builder</code> and we see it succeeded.</p>

<p><img src="/images/snyk_4b_Build.png" alt="Snyk build" /></p>

<pre><code>Tested 37 dependencies for known vulnerabilities, no vulnerable paths found.
Next steps:
- Run `snyk monitor` to be notified about new related vulnerabilities.
</code></pre>

<p>The vulnerability is fixed and the build succeeded!</p>

<p>Next, we also see <strong>Snyk</strong> successfully scanned the <code>Docker Image</code> and there were no package dependency issues with our Docker container!</p>

<pre><code>Container] 2018/11/09 03:54:14 Running command $PWDUTILS/snyk test --docker $REPOSITORY_URI:latest
Testing 300326902600.dkr.ecr.us-west-2.amazonaws.com/petstore_frontend:latest...
Organisation: sample-integrations
Package manager: rpm
Docker image: 300326902600.dkr.ecr.us-west-2.amazonaws.com/petstore_frontend:latest
✓ Tested 190 dependencies for known vulnerabilities, no vulnerable paths found.
</code></pre>

<h3 id="viewing-reporting">Viewing Reporting</h3>

<ul>
<li>Navigate back to <code>https://snyk.io/</code>.</li>
<li>You will see your  Docker Image and Java application displayed</li>
<li>Click <strong>View Report</strong></li>
<li>Set frequency project will be checked for vulnerabilities with the drop down list</li>
<li>Click on <strong>View Report</strong> and then the <strong>Dependencies</strong> tab to see what libraries were used. Click <strong>View All Dependencies</strong></li>
<li>Use the <strong>Integrations</strong> tab (optionally) to connect and automate creation of fixes against a <strong>code repository</strong>.</li>
</ul>

<p><img src="/images/snyk_5_snykUI.png" alt="Snyk UI" /></p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/40_snyk.html" title="Snyk Security"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/50_conclusion.html" title="Conclusion" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1581741991"></script>
    <script src="/js/perfect-scrollbar.min.js?1581741991"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1581741991"></script>
    <script src="/js/jquery.sticky.js?1581741991"></script>
    <script src="/js/featherlight.min.js?1581741991"></script>
    <script src="/js/highlight.pack.js?1581741991"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1581741991"></script>
    <script src="/js/learn.js?1581741991"></script>
    <script src="/js/hugo-learn.js?1581741991"></script>

    <link href="/mermaid/mermaid.css?1581741991" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1581741991"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

